<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Help"  xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

    <!-- Import required targets and configuration items. -->
    <Import Project="bin\MSBuild.Community.Tasks.Targets"/> 
    <Import Project="$(MSBuildExtensionsPath32)\Microsoft\VisualStudio\v12.0\WebApplications\Microsoft.WebApplication.targets" />
    
    <!-- Set variables. -->
    <PropertyGroup>
        <SourceLocation>.\_source</SourceLocation>
    </PropertyGroup>
    
    <!-- 
	Do XML transforms.
	This transforms all site config XMLs for each tier and saves them to that tier's _configuration folder. 
	-->
    <Target Name="DoTransforms">
    
        <Message Text="Transform NCIPL configs for $(Tier)." />
        <MakeDir Directories="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPL\"/>
        <TransformXml Source="$(SourceLocation)\NCIPL\Web.config"
                      Transform="$(SourceLocation)\NCIPL\Web.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPL\Web.config" />
        <TransformXml Source="$(SourceLocation)\NCIPL\EntLibConfig.config"
                      Transform="$(SourceLocation)\NCIPL\EntLibConfig.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPL\EntLibConfig.config" />
                      
        <Message Text="Transform NCIPLCC configs for $(Tier)." />
        <MakeDir Directories="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLCC\"/>
        <TransformXml Source="$(SourceLocation)\NCIPLCC\Web.config"
                      Transform="$(SourceLocation)\NCIPLCC\Web.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLCC\Web.config" />
        <TransformXml Source="$(SourceLocation)\NCIPLCC\EntLibConfig.config"
                      Transform="$(SourceLocation)\NCIPLCC\EntLibConfig.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLCC\EntLibConfig.config" />
                                            
        <Message Text="Transform NCIPLLM configs for $(Tier)." />
        <MakeDir Directories="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLLM\"/>
        <TransformXml Source="$(SourceLocation)\NCIPLLM\Web.config"
                      Transform="$(SourceLocation)\NCIPLLM\Web.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLLM\Web.config" />
        <TransformXml Source="$(SourceLocation)\NCIPLLM\EntLibConfig.config"
                      Transform="$(SourceLocation)\NCIPLLM\EntLibConfig.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLLM\EntLibConfig.config" />
                                            
        <Message Text="Transform PERT configs for $(Tier)." />
        <MakeDir Directories="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\PERT\"/>
        <TransformXml Source="$(SourceLocation)\PERT\Web.config"
                      Transform="$(SourceLocation)\PERT\Web.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\PERT\Web.config" />
        <TransformXml Source="$(SourceLocation)\PERT\EntLibConfig.config"
                      Transform="$(SourceLocation)\PERT\EntLibConfig.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\PERT\EntLibConfig.config" />
                      
        <Message Text="Transform KIOSK configs for $(Tier)." />
        <MakeDir Directories="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\KIOSK\"/>
        <TransformXml Source="$(SourceLocation)\KIOSK\Web.config"
                      Transform="$(SourceLocation)\KIOSK\Web.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\KIOSK\Web.config" />
        <TransformXml Source="$(SourceLocation)\KIOSK\EntLibConfig.config"
                      Transform="$(SourceLocation)\KIOSK\EntLibConfig.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\KIOSK\EntLibConfig.config" />
                      
        <Message Text="Transform NCIPLEX configs for $(Tier)." />
        <MakeDir Directories="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLEX\"/>
        <TransformXml Source="$(SourceLocation)\NCIPLEX\Web.config"
                      Transform="$(SourceLocation)\NCIPLEX\Web.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLEX\Web.config" />                      
        <TransformXml Source="$(SourceLocation)\NCIPLEX\EntLibConfig.config"
                      Transform="$(SourceLocation)\NCIPLEX\EntLibConfig.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLEX\EntLibConfig.config" />
                      
        <Message Text="Transform NCIPLAdmin configs for $(Tier)." />
        <MakeDir Directories="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLAdmin\"/>
        <TransformXml Source="$(SourceLocation)\NCIPLAdmin\Web.config"
                      Transform="$(SourceLocation)\NCIPLAdmin\Web.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLAdmin\Web.config" />
        <TransformXml Source="$(SourceLocation)\NCIPLAdmin\EntLibConfig.config"
                      Transform="$(SourceLocation)\NCIPLAdmin\EntLibConfig.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\NCIPLAdmin\EntLibConfig.config" />

        <Message Text="Transform ApplicationManagement configs for $(Tier)." />
        <MakeDir Directories="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\ApplicationManagement\"/>
        <TransformXml Source="$(SourceLocation)\ApplicationManagement\Web.config"
                      Transform="$(SourceLocation)\ApplicationManagement\Web.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\ApplicationManagement\Web.config" />
        <MakeDir Directories="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\ApplicationManagement\Views\"/>
        <TransformXml Source="$(SourceLocation)\ApplicationManagement\Views\Web.config"
                      Transform="$(SourceLocation)\ApplicationManagement\Views\Web.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\ApplicationManagement\Views\Web.config" />
                      
        <Message Text="Transform GUAM configs for $(Tier)." />
        <MakeDir Directories="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\GUAM\"/>
        <TransformXml Source="$(SourceLocation)\GUAM\Web.config"
                      Transform="$(SourceLocation)\GUAM\Web.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\GUAM\Web.config" />
                      
         <Message Text="Transform root configs for $(Tier)." />
        <MakeDir Directories="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\root\"/>
        <TransformXml Source="$(SourceLocation)\root\Web.config"
                      Transform="$(SourceLocation)\root\Web.$(Tier).config"
                      Destination="$(SourceLocation)\_configurations\PubsLocator_$(Tier)\root\Web.config" />
        
    </Target>
    
</Project>